library(plotly)
library(googleVis)
library(stringr)
realestate <- read.csv(file = "./data/nyc-rolling-sales.csv",stringsAsFactors = FALSE)
re <- realestate %>% filter(., BOROUGH == 1) %>% select(.,BOROUGH,NEIGHBORHOOD,SALE.PRICE) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%  filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD))))) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.SALE_PRC=mean(SALE.PRICE))
#write.csv(re, "re.csv", row.names = F)
cr_mhn <- read.csv(file = "./data/craigslist_mnh_clean.tsv",sep = "\t",stringsAsFactors = FALSE)
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.RENTAL_PRC=mean(price)) %>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(AVG.SALE_PRC))
setwd("~/NYCDSA/craigslist_selenium")
library(data.table)
library(dplyr)
library(tidyr)
library(ggplot2)
library(plotly)
library(googleVis)
library(stringr)
realestate <- read.csv(file = "./data/nyc-rolling-sales.csv",stringsAsFactors = FALSE)
re <- realestate %>% filter(., BOROUGH == 1) %>% select(.,BOROUGH,NEIGHBORHOOD,SALE.PRICE) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%  filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD))))) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.SALE_PRC=mean(SALE.PRICE))
#write.csv(re, "re.csv", row.names = F)
cr_mhn <- read.csv(file = "./data/craigslist_mnh_clean.tsv",sep = "\t",stringsAsFactors = FALSE)
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.RENTAL_PRC=mean(price)) %>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(AVG.SALE_PRC))
by_HOOD
ggplot(by_HOOD, aes(AVG.RENTAL_PRC, AVG.SALE_PRC)) +
geom_point()
realestate
re <- realestate %>% filter(., BOROUGH == 1) %>% select(.,BOROUGH,NEIGHBORHOOD,SALE.PRICE) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%  filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD))))) %>%
mutate(., TOTAL.UNITS = RESIDENTIAL.UNITS+COMMERCIAL.UNITS,
PRICE.PER.SQ=SALE.PRICE/GROSS.SQUARE.FEET,
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.SALE_PRC=mean(SALE.PRICE),
AVG.PRC.PER.UNIT = mean(PRICE.PER.UNIT),
AVG.PRC.PER.SQ = mean(PRICE.PER.SQ))
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.RENTAL_PRC=mean(price)) %>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(AVG.SALE_PRC))
ggplot(by_HOOD, aes(AVG.RENTAL_PRC, AVG.PRC.PER.UNIT)) +
geom_point()
re
re <- realestate %>% filter(., BOROUGH == 1) %>% select(.,BOROUGH,NEIGHBORHOOD,SALE.PRICE) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%  filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD))))) %>%
mutate(., TOTAL.UNITS = RESIDENTIAL.UNITS+COMMERCIAL.UNITS,
PRICE.PER.SQ=SALE.PRICE/GROSS.SQUARE.FEET,
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.SALE_PRC=mean(SALE.PRICE),
AVG.PRC.PER.UNIT = mean(PRICE.PER.UNIT),
AVG.PRC.PER.SQ = mean(PRICE.PER.SQ))
re
re <- realestate %>% filter(., BOROUGH == 1) %>% select(.,BOROUGH,NEIGHBORHOOD,SALE.PRICE) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%  filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD))))) %>%
mutate(., TOTAL.UNITS = RESIDENTIAL.UNITS+COMMERCIAL.UNITS,
PRICE.PER.SQ=SALE.PRICE/GROSS.SQUARE.FEET,
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.SALE_PRC=mean(SALE.PRICE),
AVG.PRC.PER.UNIT = mean(PRICE.PER.UNIT),
AVG.PRC.PER.SQ = mean(PRICE.PER.SQ))
re
re <- realestate %>% filter(., BOROUGH == 1) %>% select(.,BOROUGH,NEIGHBORHOOD,SALE.PRICE) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%  filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = RESIDENTIAL.UNITS+COMMERCIAL.UNITS,
PRICE.PER.SQ=SALE.PRICE/GROSS.SQUARE.FEET,
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.SALE_PRC=mean(SALE.PRICE),
AVG.PRC.PER.UNIT = mean(PRICE.PER.UNIT),
AVG.PRC.PER.SQ = mean(PRICE.PER.SQ))
#write.csv(re, "re.csv", row.names = F)
re
realestate
re <- realestate %>% filter(., BOROUGH == 1) %>% select(.,BOROUGH,NEIGHBORHOOD,SALE.PRICE) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%  filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.SALE_PRC=mean(SALE.PRICE),
AVG.PRC.PER.UNIT = mean(PRICE.PER.UNIT),
AVG.PRC.PER.SQ = mean(PRICE.PER.SQ))
re <- realestate %>%
filter(., BOROUGH == 1) %>% select(.,BOROUGH,NEIGHBORHOOD,SALE.PRICE) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
group_by(., NEIGHBORHOOD) %>%
summarise(., AVG.SALE_PRC=mean(SALE.PRICE),
AVG.PRC.PER.UNIT = mean(PRICE.PER.UNIT),
AVG.PRC.PER.SQ = mean(PRICE.PER.SQ))
realestate <- read.csv(file = "./data/nyc-rolling-sales.csv",stringsAsFactors = FALSE)
re <- realestate %>%
filter(., BOROUGH == 1) %>% select(.,BOROUGH,NEIGHBORHOOD,SALE.PRICE) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
group_by(., NEIGHBORHOOD) %>%
summarise(., AVG.SALE_PRC=mean(SALE.PRICE),
AVG.PRC.PER.UNIT = mean(PRICE.PER.UNIT),
AVG.PRC.PER.SQ = mean(PRICE.PER.SQ))
re
re <- realestate %>%
filter(., BOROUGH == 1) %>% select(.,BOROUGH,NEIGHBORHOOD,SALE.PRICE) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS)
re
realestate %>%
filter(., BOROUGH == 1) %>% select(.,BOROUGH,NEIGHBORHOOD,SALE.PRICE) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS)
realestate
re <- realestate %>%
filter(., BOROUGH == 1) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
group_by(., NEIGHBORHOOD) %>%
summarise(., AVG.SALE_PRC=mean(SALE.PRICE),
AVG.PRC.PER.UNIT = mean(PRICE.PER.UNIT),
AVG.PRC.PER.SQ = mean(PRICE.PER.SQ))
re
re <- realestate %>%
filter(., BOROUGH == 1) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS)
re
re <- realestate %>%
filter(., BOROUGH == 1) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
filter(., GROSS.SQUARE.FEET >1) %>%
group_by(., NEIGHBORHOOD) %>%
summarise(., AVG.SALE_PRC=mean(SALE.PRICE),
AVG.PRC.PER.UNIT = mean(PRICE.PER.UNIT),
AVG.PRC.PER.SQ = mean(PRICE.PER.SQ))
re
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.RENTAL_PRC=mean(price)) %>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(AVG.SALE_PRC))
ggplot(by_HOOD, aes(AVG.RENTAL_PRC, AVG.PRC.PER.UNIT)) +
geom_point()
ggplot(by_HOOD, aes(AVG.RENTAL_PRC, AVG.PRC.PER.SQ ) +
ggplot(by_HOOD, aes(AVG.RENTAL_PRC, AVG.PRC.PER.SQ)) +
geom_point()
ggplot(by_HOOD, aes(AVG.RENTAL_PRC, AVG.PRC.PER.SQ)) +
geom_point()
by_HOOD
ggplot(by_HOOD %>% select(AVG.RENTAL_PRC, AVG.PRC.PER.SQ),
aes(AVG.RENTAL_PRC, AVG.PRC.PER.SQ)) +
geom_point()
cr_mhn
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
filter(., !is.na(ft2)) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.RENTAL.PRC.PER.SQ=mean(price/as.integer(ft2)))%>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(AVG.SALE_PRC))
ggplot(by_HOOD %>% select(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ),
aes(AVG.RENTAL_PRC, AVG.PRC.PER.SQ)) +
geom_point()
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
filter(., !is.na(ft2)) %>%
group_by(., NEIGHBORHOOD) %>% summarise(., AVG.RENTAL.PRC.PER.SQ=mean(price/as.integer(ft2)))%>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(AVG.SALE_PRC))
ggplot(by_HOOD %>% select(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ),
aes(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ)) +
geom_point()
ggplot(by_HOOD %>% select(NEIGHBORHOOD, AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ),
aes(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ)) +
geom_point(aes(color = NEIGHBORHOOD))
ggplot(by_HOOD %>% select(NEIGHBORHOOD, AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ),
aes(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ, label = NEIGHBORHOOD)) +
geom_point()+
geom_text(size = 4)
ggplot(by_HOOD %>% select(NEIGHBORHOOD, AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ) %>%
filter(., NEIGHBORHOOD != 'TRIBECA'),
aes(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ, label = NEIGHBORHOOD)) +
geom_point()+
geom_text(size = 4)
by_HOOD
cr_mhn
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
filter(., !is.na(ft2)) %>% filter(., br != "") %>%
group_by(., NEIGHBORHOOD, br) %>% summarise(., AVG.RENTAL.PRC.PER.SQ=mean(price/as.integer(ft2)))%>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(AVG.SALE_PRC))
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
filter(., !is.na(ft2)) %>% filter(., br != "") %>%
group_by(., br, NEIGHBORHOOD) %>% summarise(., AVG.RENTAL.PRC.PER.SQ=mean(price/as.integer(ft2)))%>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(AVG.SALE_PRC))
by_HOOD
ggplot(by_HOOD %>% select(NEIGHBORHOOD, AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ) %>%
filter(., NEIGHBORHOOD != 'TRIBECA'),
aes(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ, label = NEIGHBORHOOD)) +
geom_point() +
geom_text(size = 4) +
facet_wrap(~br)
ggplot(by_HOOD %>% select(NEIGHBORHOOD, AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ, label = NEIGHBORHOOD)) +
geom_point() +
geom_text(size = 4) +
facet_wrap(~br)
ggplot(by_HOOD %>% select(NEIGHBORHOOD, AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ,
label = NEIGHBORHOOD,
group = br)) +
geom_point() +
geom_text(size = 4) +
facet_wrap(~br)
ggplot(by_HOOD %>% select(NEIGHBORHOOD, AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ,
label = NEIGHBORHOOD)) +
geom_point(aes(group=br)) +
geom_text(size = 4) +
facet_wrap(~br)
ggplot(by_HOOD %>% select(NEIGHBORHOOD, AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ,
label = NEIGHBORHOOD)) +
geom_point(aes(group=br)) +
geom_text(size = 4) +
facet_wrap(~br)
re
re <- realestate %>%
filter(., BOROUGH == 1) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
filter(., GROSS.SQUARE.FEET >1)
re
re <- realestate %>%
filter(., BOROUGH == 1) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>% filter(., COMMERCIAL.UNITS ==0) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
filter(., GROSS.SQUARE.FEET >1) %>%
group_by(., NEIGHBORHOOD) %>%
summarise(., AVG.SALE_PRC=mean(SALE.PRICE),
AVG.PRC.PER.UNIT = mean(PRICE.PER.UNIT),
AVG.PRC.PER.SQ = mean(PRICE.PER.SQ))
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
filter(., !is.na(ft2)) %>% filter(., br != "") %>%
group_by(., br, NEIGHBORHOOD) %>% summarise(., AVG.RENTAL.PRC.PER.SQ=mean(price/as.integer(ft2)))%>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(AVG.SALE_PRC))
ggplot(by_HOOD %>% select(NEIGHBORHOOD, AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ,
label = NEIGHBORHOOD)) +
geom_point(aes(group=br)) +
geom_text(size = 4) +
facet_wrap(~br)
ggplot(by_HOOD %>% select(NEIGHBORHOOD, AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(AVG.RENTAL.PRC.PER.SQ, AVG.PRC.PER.SQ,
label = NEIGHBORHOOD)) +
geom_point(aes(group=br)) +
#geom_text(size = 4) +
facet_wrap(~br)
cr_mhn
cr_mhn
cr_mhn <- group_by(., br, neighborhood) %>% summarise(., avg.price = median(price))
cr_mhn %>%  group_by(., br, neighborhood) %>% summarise(., avg.price = median(price))
re <- realestate %>%
filter(., BOROUGH == 1) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>% filter(., COMMERCIAL.UNITS ==0) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
filter(., GROSS.SQUARE.FEET >1) %>%
group_by(., NEIGHBORHOOD) %>%
summarise(., AVG.SALE_PRC=median(SALE.PRICE),
AVG.PRC.PER.UNIT = median(PRICE.PER.UNIT),
AVG.PRC.PER.SQ = median(PRICE.PER.SQ))
cr_mhn <- read.csv(file = "./data/craigslist_mnh_clean.tsv",sep = "\t",stringsAsFactors = FALSE)
re <- realestate %>%
filter(., BOROUGH == 1) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>% filter(., COMMERCIAL.UNITS ==0) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
filter(., GROSS.SQUARE.FEET >1) %>%
group_by(., NEIGHBORHOOD) %>%
summarise(., SALE_PRC=median(SALE.PRICE),
PRC.PER.UNIT = median(PRICE.PER.UNIT),
PRC.PER.SQ = median(PRICE.PER.SQ))
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
filter(., !is.na(ft2)) %>% filter(., br != "") %>%
group_by(., br, NEIGHBORHOOD) %>% summarise(., RENTAL.PRC.PER.SQ=median(price/as.integer(ft2)))%>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(SALE_PRC))
ggplot(by_HOOD %>% select(NEIGHBORHOOD, RENTAL.PRC.PER.SQ, PRC.PER.SQ) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(RENTAL.PRC.PER.SQ, PRC.PER.SQ,
label = NEIGHBORHOOD)) +
geom_point(aes(group=br)) +
#geom_text(size = 4) +
facet_wrap(~br)
ggplot(by_HOOD %>% select(NEIGHBORHOOD, RENTAL.PRC.PER.SQ, PRC.PER.SQ) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(RENTAL.PRC.PER.SQ, PRC.PER.SQ,
label = NEIGHBORHOOD)) +
geom_point(aes(group=br))
ggplot(by_HOOD %>% select(NEIGHBORHOOD, RENTAL.PRC.PER.SQ, PRC.PER.SQ) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(RENTAL.PRC.PER.SQ, PRC.PER.SQ,
label = NEIGHBORHOOD)) +
geom_point()
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
filter(., !is.na(ft2)) %>% filter(., br != "") %>%
group_by(., NEIGHBORHOOD) %>% summarise(., RENTAL.PRC.PER.SQ=median(price/as.integer(ft2)))%>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(SALE_PRC))
ggplot(by_HOOD %>% select(NEIGHBORHOOD, RENTAL.PRC.PER.SQ, PRC.PER.SQ) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(RENTAL.PRC.PER.SQ, PRC.PER.SQ,
label = NEIGHBORHOOD)) +
geom_point()
realestate
re <- realestate %>%
filter(., BOROUGH == 1) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>% filter(., COMMERCIAL.UNITS ==0) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/RESIDENTIAL.UNITS) %>%
filter(., GROSS.SQUARE.FEET >1)
by_hood <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
filter(., !is.na(ft2)) %>% filter(., br != "") %>%
mutate(., RENTAL.PRC.PER.SQ=price/as.integer(ft2))%>%
left_join(.,re, by='NEIGHBORHOOD')
by_hood
ggplot(by_HOOD %>% select(NEIGHBORHOOD, RENTAL.PRC.PER.SQ, PRC.PER.SQ) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(RENTAL.PRC.PER.SQ, PRC.PER.SQ,
label = NEIGHBORHOOD)) +
geom_point()
ggplot(by_HOOD %>% select(NEIGHBORHOOD, RENTAL.PRC.PER.SQ, PRC.PER.UNIT) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(RENTAL.PRC.PER.SQ, PRC.PER.SQ,
label = NEIGHBORHOOD)) +
geom_point()
re <- realestate %>%
filter(., BOROUGH == 1) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>% filter(., COMMERCIAL.UNITS ==0) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
filter(., GROSS.SQUARE.FEET >1) %>%
group_by(., NEIGHBORHOOD) %>%
summarise(., SALE_PRC=median(SALE.PRICE),
PRC.PER.UNIT = median(PRICE.PER.UNIT),
PRC.PER.SQ = median(PRICE.PER.SQ))
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
filter(., !is.na(ft2)) %>% filter(., br != "") %>%
group_by(., NEIGHBORHOOD) %>% summarise(., RENTAL.PRC.PER.SQ=median(price/as.integer(ft2)))%>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(SALE_PRC))
ggplot(by_HOOD %>% select(NEIGHBORHOOD, RENTAL.PRC.PER.SQ, PRC.PER.UNIT) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(RENTAL.PRC.PER.SQ, PRC.PER.SQ,
label = NEIGHBORHOOD)) +
geom_point()
by_HOOD
ggplot(by_HOOD %>% select(NEIGHBORHOOD, RENTAL.PRC.PER.SQ, PRC.PER.UNIT) %>%
filter(., !NEIGHBORHOOD %in% c('TRIBECA','CHELSEA')),
aes(RENTAL.PRC.PER.SQ, PRC.PER.UNIT,
label = NEIGHBORHOOD)) +
geom_point()
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
filter(., !is.na(ft2)) %>% filter(., br != "") %>%
group_by(., NEIGHBORHOOD) %>% summarise(., RENTAL.PRC.PER.SQ=median(price/as.integer(ft2)))
by_HOOD
re <- realestate %>%
filter(., BOROUGH == 1) %>%
mutate(.,SALE.PRICE= as.integer(SALE.PRICE)) %>%
filter(., !is.na(SALE.PRICE)) %>% filter(., COMMERCIAL.UNITS ==0) %>%
mutate(., NEIGHBORHOOD = if_else(grepl('\\(',NEIGHBORHOOD),gsub(' \\(.*','', NEIGHBORHOOD),
if_else(grepl('-',NEIGHBORHOOD),gsub('-.*','',NEIGHBORHOOD),
if_else(grepl('FINANCIAL',NEIGHBORHOOD),gsub('FINANCIAL','FINANCIAL DISTRICT',NEIGHBORHOOD),
if_else(grepl('CBD',NEIGHBORHOOD),gsub(' CBD','',NEIGHBORHOOD),NEIGHBORHOOD)))),
TOTAL.UNITS = as.integer(RESIDENTIAL.UNITS) + as.integer(COMMERCIAL.UNITS),
PRICE.PER.SQ=SALE.PRICE/as.integer(GROSS.SQUARE.FEET),
PRICE.PER.UNIT = SALE.PRICE/TOTAL.UNITS) %>%
filter(., GROSS.SQUARE.FEET >1) %>%
group_by(., NEIGHBORHOOD) %>%
summarise(., COUNT = n(),SALE_PRC=median(SALE.PRICE),
PRC.PER.UNIT = median(PRICE.PER.UNIT),
PRC.PER.SQ = median(PRICE.PER.SQ))
by_HOOD <- cr_mhn %>% mutate(., NEIGHBORHOOD = str_to_upper(neighborhood, locale = "en"))%>%
mutate(., NEIGHBORHOOD = ifelse(grepl('/',NEIGHBORHOOD),gsub(' /.*','',NEIGHBORHOOD), NEIGHBORHOOD)) %>%
filter(., !is.na(ft2)) %>% filter(., br != "") %>%
group_by(., NEIGHBORHOOD) %>% summarise(., Count = n(),RENTAL.PRC.PER.SQ=median(price/as.integer(ft2)))%>%
left_join(.,re, by='NEIGHBORHOOD') %>% filter(., !is.na(SALE_PRC))
by_HOOD
