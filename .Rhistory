joinDF <- cr_unique %>% group_by(., NEIGHBORHOOD, br_cat) %>%
summarise(., mean.price.cr = mean(price), med.price.cr = median(price)) %>%
inner_join(., rh %>% group_by(., NEIGHBORHOOD, br_cat) %>%
summarise(., mean.price.rh = mean(price), med.price.rh = median(price)),
by=c('NEIGHBORHOOD','br_cat')) %>%
mutate(., mean_diff=mean.price.cr-mean.price.rh, med_diff=med.price.cr - med.price.rh,
mean.diff.perc=round(mean_diff/mean.price.rh*100,2), med.diff.perc=round(med_diff/med.price.rh*100,2))
# compare mean rents
ggplot(joinDF %>% gather(., key=key, value=value, c("med.price.cr","med.price.rh")) %>%
arrange(., NEIGHBORHOOD, br_cat, key), aes(NEIGHBORHOOD, value)) +
geom_col(aes(x=reorder(NEIGHBORHOOD,value),fill=key), position='dodge') +
scale_fill_manual(values = c("#871551","#5815AD"))+
xlab("")+
ylab("")+
ggtitle("")+
coord_flip()
# mean rent price diff.
ggplot(joinDF %>% filter(., NEIGHBORHOOD != 'Downtown') %>% group_by(., NEIGHBORHOOD) %>%
summarise(., mean=round(mean(mean.diff.perc),2)),
aes(NEIGHBORHOOD, mean,label = paste0(mean,"%"))) +
geom_col(aes(x=reorder(NEIGHBORHOOD, mean)), fill='#5815AD') +
xlab("")+
ylab("")+
geom_text(size = 3, color='white', position = position_stack(reverse = T,vjust = 0.5)) +
ggtitle("")+
coord_flip()+
ggsave("./ppt/RH_CR_Mean_Perc.png", width = 14, height = 5)
# compare mean rents
ggplot(joinDF %>% gather(., key=key, value=value, c("med.price.cr","med.price.rh")) %>%
arrange(., NEIGHBORHOOD, br_cat, key), aes(NEIGHBORHOOD, value)) +
geom_col(aes(x=reorder(NEIGHBORHOOD,value),fill=key), position='dodge') +
scale_fill_manual(values = c("#871551","#5815AD"))+
xlab("")+
ylab("")+
ggtitle("")+
coord_flip()
# compare mean rents
ggplot(joinDF %>% gather(., key=key, value=value, c("med.price.cr","med.price.rh")) %>%
mutate(., key=ifelse(key=="med.price.cr","Craigslist",'Renthop')) %>%
arrange(., NEIGHBORHOOD, br_cat, key), aes(NEIGHBORHOOD, value)) +
geom_col(aes(x=reorder(NEIGHBORHOOD,value),fill=key), position='dodge') +
scale_fill_manual(values = c("#871551","#5815AD"))+
xlab("")+
ylab("")+
ggtitle("")+
coord_flip()
# compare mean rents
ggplot(joinDF %>% gather(., key=key, value=value, c("med.price.cr","med.price.rh")) %>%
mutate(., key=ifelse(key=="med.price.cr","Craigslist",'Renthop')) %>%
arrange(., NEIGHBORHOOD, br_cat, key), aes(NEIGHBORHOOD, value)) +
geom_col(aes(x=reorder(NEIGHBORHOOD,value),fill=key), position='dodge') +
scale_fill_manual(values = c("#5815AD","#871551"))+
labs(fill = "Median Price")+
xlab("")+
ylab("")+
ggtitle("")+
coord_flip()
# compare mean rents
ggplot(joinDF %>% gather(., key=key, value=value, c("med.price.cr","med.price.rh")) %>%
mutate(., key=ifelse(key=="med.price.cr","Craigslist",'Renthop')) %>%
arrange(., NEIGHBORHOOD, br_cat, key), aes(NEIGHBORHOOD, value)) +
geom_col(aes(x=reorder(NEIGHBORHOOD,value),fill=key), position='dodge') +
scale_fill_manual(values = c("#5815AD","#871551"))+
labs(fill = "Median Rent")+
xlab("")+
ylab("")+
ggtitle("")+
coord_flip()
# compare mean rents
ggplot(joinDF %>% gather(., key=key, value=value, c("med.price.cr","med.price.rh")) %>%
mutate(., key=ifelse(key=="med.price.cr","Craigslist",'Renthop')) %>%
arrange(., NEIGHBORHOOD, br_cat, key), aes(NEIGHBORHOOD, value)) +
geom_col(aes(x=reorder(NEIGHBORHOOD,value),fill=key), position='dodge') +
scale_fill_manual(values = c("#5815AD","#871551"))+
labs(fill = "Median Rent")+
xlab("")+
ylab("")+
ggtitle("")+
coord_flip()+
ggsave("./ppt/RH_vs_CR_median.png", width = 5, height = 5)
# med rent price diff
ggplot(df,aes(NEIGHBORHOOD, mean, label=paste0(mean,"%"))) +
geom_col(aes(x=reorder(NEIGHBORHOOD, mean)), fill='#5815AD') +
coord_flip()+
facet_wrap(~br_cat)+
xlab("")+
ylab("")+
geom_text(size = 3, color='white', position = position_stack(reverse = T,vjust = 0.5)) +
ggtitle("")+
ggsave("./ppt/RH_CR_Median_Perc.png", width = 5, height = 5)
df <- joinDF %>% group_by(.,NEIGHBORHOOD, br_cat) %>% summarise(.,mean=round(mean(med.diff.perc),2))
df
# med rent price diff
ggplot(df,aes(NEIGHBORHOOD, mean, label=paste0(mean,"%"))) +
geom_col(aes(x=reorder(NEIGHBORHOOD, mean)), fill='#5815AD') +
coord_flip()+
facet_wrap(~br_cat)+
xlab("")+
ylab("")+
geom_text(size = 3, color='white', position = position_stack(reverse = T,vjust = 0.5)) +
ggtitle("")+
ggsave("./ppt/RH_CR_Median_Perc.png", width = 5, height = 5)
# med rent price diff
ggplot(df,aes(NEIGHBORHOOD, mean, label=paste0(mean,"%"))) +
geom_col(aes(x=reorder(NEIGHBORHOOD, mean)), fill='#5815AD') +
coord_flip()+
xlab("")+
ylab("")+
geom_text(size = 3, color='white', position = position_stack(reverse = T,vjust = 0.5)) +
ggtitle("")+
ggsave("./ppt/RH_CR_Median_Perc.png", width = 5, height = 5)
df <- joinDF %>% group_by(.,NEIGHBORHOOD) %>% summarise(.,mean=round(mean(med.diff.perc),2))
# med rent price diff
ggplot(df,aes(NEIGHBORHOOD, mean, label=paste0(mean,"%"))) +
geom_col(aes(x=reorder(NEIGHBORHOOD, mean)), fill='#5815AD') +
coord_flip()+
xlab("")+
ylab("")+
geom_text(size = 3, color='white', position = position_stack(reverse = T,vjust = 0.5)) +
ggtitle("")+
ggsave("./ppt/RH_CR_Median_Perc.png", width = 5, height = 5)
##242C62 - background
ggplot(pets_allowed_perc %>% filter(., !neighborhood %in% c('Union Square','Downtown')), aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
facet_wrap(~Type, scales = "free")+
ylab("")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium_perc.png", width = 10, height = 5)
df <- joinDF %>% group_by(.,NEIGHBORHOOD) %>% summarise(.,mean=round(mean(med.diff.perc),2)) %>%
filter(., NEIGHBORHOOD %in% c('Union Square', 'Downtown'))
# med rent price diff
ggplot(df,aes(NEIGHBORHOOD, mean, label=paste0(mean,"%"))) +
geom_col(aes(x=reorder(NEIGHBORHOOD, mean)), fill='#5815AD') +
coord_flip()+
xlab("")+
ylab("")+
geom_text(size = 3, color='white', position = position_stack(reverse = T,vjust = 0.5)) +
ggtitle("")+
ggsave("./ppt/RH_CR_Median_Perc.png", width = 5, height = 5)
df <- joinDF %>% group_by(.,NEIGHBORHOOD) %>% summarise(.,mean=round(mean(med.diff.perc),2)) %>%
filter(., !NEIGHBORHOOD %in% c('Union Square', 'Downtown'
))
# med rent price diff
ggplot(df,aes(NEIGHBORHOOD, mean, label=paste0(mean,"%"))) +
geom_col(aes(x=reorder(NEIGHBORHOOD, mean)), fill='#5815AD') +
coord_flip()+
xlab("")+
ylab("")+
geom_text(size = 3, color='white', position = position_stack(reverse = T,vjust = 0.5)) +
ggtitle("")+
ggsave("./ppt/RH_CR_Median_Perc.png", width = 5, height = 5)
data_uniq
data_uniq <- mutate(., pets_ok=if(dogs_allowed==0&cats_allowed==0, "Pets Not Allowed", "Pets Allowed"))
data_uniq <- mutate(., pets_ok=ifelse(dogs_allowed==0&cats_allowed==0, "Pets Not Allowed", "Pets Allowed"))
nyc <- nyc %>% mutate(.,pets_ok=ifelse(dogs_allowed==0&cats_allowed==0, "Pets Not Allowed", "Pets Allowed"))
nyc %>% group_by(.,boro, pets_allowed_perc) %>% summarise(., median(price))
nyc %>% group_by(.,boro, pets_allowed) %>% summarise(., median(price))
nyc %>% group_by(.,boro, pets_ok) %>% summarise(., median(price))
nyc %>% group_by(.,borough, pets_ok) %>% summarise(., median(price))
nyc %>% group_by(.,borough, pets_ok) %>% summarise(., count=n(), med.rent=median(price)) %>%
left_join(nyc %>% group_by(., borough) %>% summarise(., count_total=n(), median.rent=median(price)),
by='borough')
nyc %>% group_by(.,borough, pets_ok) %>% summarise(., count=n()) %>%
left_join(nyc %>% group_by(., borough) %>% summarise(., count_total=n()),
by='borough') %>%
mutate (., pets_ok_perc=round(count/count_total*100,2))
nyc %>% group_by(.,borough, pets_ok) %>% summarise(., count=n()) %>%
left_join(nyc %>% group_by(., borough) %>% summarise(., count_total=n()),
by='borough') %>%
mutate (., pets_ok_perc=round(count/count_total*100,2)) %>% filter(., pets_ok=='Pets Allowed')
ggplot(nyc_pets_ok_perc, aes(borough, pets_ok_perc, label=paste0(pets_ok_perc, "%"))) +
geom_col(aes(x=reorder(borough,desc(pets_ok_perc))), fill="#5815AD") +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
xlab("") +
ylab("") +
ggsave("./ppt/boro_pets_allowed_perc.png", width = 6, height = 4)
nyc_pets_ok_perc <- nyc %>% group_by(.,borough, pets_ok) %>% summarise(., count=n()) %>%
left_join(nyc %>% group_by(., borough) %>% summarise(., count_total=n()),
by='borough') %>%
mutate (., pets_ok_perc=round(count/count_total*100,2)) %>% filter(., pets_ok=='Pets Allowed')
ggplot(nyc_pets_ok_perc, aes(borough, pets_ok_perc, label=paste0(pets_ok_perc, "%"))) +
geom_col(aes(x=reorder(borough,desc(pets_ok_perc))), fill="#5815AD") +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
xlab("") +
ylab("") +
ggsave("./ppt/boro_pets_allowed_perc.png", width = 6, height = 4)
ggplot(nyc_pets_ok_perc, aes(borough, pets_ok_perc, label=paste0(pets_ok_perc, "%"))) +
geom_col(aes(x=reorder(borough,desc(pets_ok_perc))), fill="#5815AD") +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
xlab("") +
ylab("pets allowed listings/ total listings") +
ggsave("./ppt/boro_pets_allowed_perc.png", width = 6, height = 4)
ggplot(nyc_pets_ok_perc, aes(borough, pets_ok_perc, label=paste0(pets_ok_perc, "%"))) +
geom_col(aes(x=reorder(borough,desc(pets_ok_perc))), fill="#5815AD") +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
xlab("") +
ylab("pets allowed listings/ total listings") +
ggsave("./ppt/boro_pets_allowed_perc.png", width = 3, height = 3)
ggplot(nyc_pets_ok_perc, aes(borough, pets_ok_perc, label=paste0(pets_ok_perc, "%"))) +
geom_col(aes(x=reorder(borough,desc(pets_ok_perc))), fill="#5815AD") +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
xlab("") +
ylab("pets allowed listings/ total listings") +
ggsave("./ppt/boro_pets_allowed_perc.png", width = 4, height = 3)
nyc_pets_ok_perc
nyc %>% group_by(.,borough, pets_ok) %>% summarise(., count=n()) %>%
left_join(nyc %>% group_by(., borough) %>% summarise(., count_total=n()),
by='borough') %>%
mutate (., pets_ok_perc=round(count/count_total*100,2))
nyc %>% group_by(.,borough, pets_ok) %>% summarise(., price = round(median(price))) %>%
spread(., pets_ok, price)
nyc %>% group_by(.,borough, pets_ok) %>% summarise(., price = round(median(price))) %>%
spread(., pets_ok, price) %>% mutate(., diff = `Pets Allowed`-`Pets Not Allowed`,
perc = round(100*diff/`Pets Not Allowed`,2))
nyc_pet_premium <- nyc %>% group_by(.,borough, pets_ok) %>% summarise(., price = round(median(price))) %>%
spread(., pets_ok, price) %>% mutate(., diff = `Pets Allowed`-`Pets Not Allowed`,
perc = round(100*diff/`Pets Not Allowed`,2))
ggplot(nyc_pet_premium, aes(borough, perc, label=paste0(perc, "%"))) +
geom_col(aes(x=reorder(borough,desc(perc))), fill="#5815AD") +
coord_flip()+
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
xlab("") +
ylab("pets allowed listings/ total listings") +
ggsave("./ppt/boro_pets_allowed_perc.png", width = 4, height = 3)
ggplot(nyc_pets_ok_perc, aes(borough, pets_ok_perc, label=paste0(pets_ok_perc, "%"))) +
geom_col(aes(x=reorder(borough,desc(pets_ok_perc))), fill="#5815AD") +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
xlab("") +
ylab("pets allowed listings/ total listings") +
ggsave("./ppt/boro_pets_allowed_perc.png", width = 4, height = 3)
ggplot(nyc_pet_premium, aes(borough, perc, label=paste0(perc, "%"))) +
geom_col(aes(x=reorder(borough,perc)), fill="#5815AD") +
coord_flip()+
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
xlab("") +
ylab("pets allowed listings/ total listings") +
ggsave("./ppt/boro_pets_premium.png", width = 4, height = 3)
ggplot(nyc_pet_premium, aes(borough, perc, label=paste0(perc, "%"))) +
geom_col(aes(x=reorder(borough,perc)), fill="#5815AD") +
coord_flip()+
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
xlab("") +
ylab("pets allowed listings/ total listings") +
ggsave("./ppt/boro_pets_premium.png", width = 3, height = 3)
ggplot(nyc_pet_premium, aes(borough, perc, label=paste0(perc, "%"))) +
geom_col(aes(x=reorder(borough,perc)), fill="#5815AD") +
coord_flip()+
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
xlab("") +
ylab("pets allowed listings/ total listings") +
ggsave("./ppt/boro_pets_premium.png", width = 3, height = 3)
ggplot(nyc_pet_premium, aes(borough, perc, label=paste0(perc, "%"))) +
geom_col(aes(x=reorder(borough,perc)), fill="#5815AD") +
coord_flip()+
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
xlab("") +
ylab("pets allowed listings/ total listings") +
ggsave("./ppt/boro_pets_premium.png", width = 4, height = 3)
cr_unique <- cr %>% filter(., is.na(repost_of))
nrow(cr_unique)
nrow(cr)
nrow(cr_unique) /nrow(cr) #4014
cr_unique
# 'pet premium'
pets_premium <- cr_unique %>% mutate(., pets_ok=ifelse(dogs_allowed==0&cats_allowed==0, "No", "Yes")) %>%
group_by(., neighborhood, pets_ok) %>%
summarise(., price = round(median(price))) %>%
spread(., pets_ok, price) %>%
mutate(., More = Yes - No, Perc = round(More/No*100))
pets_premium
# 'pet premium'
pets_premium <- cr_unique %>% mutate(., pets_ok=ifelse(dogs_allowed==0&cats_allowed==0, "No", "Yes")) %>%
group_by(., neighborhood, pets_ok) %>%
summarise(., price = round(median(price))) %>%
spread(., pets_ok, price) %>%
mutate(., More = Yes - No, Perc = round(More/No*100), Perc=ifelse(is.na(Perc),0,Perc))
pets_premium
ggplot(pets_premium #%>% filter(., !neighborhood %in% c('Union Square','Downtown'))
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium_perc.png", width = 10, height = 5)
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
ggplot(pets_premium #%>% filter(., !neighborhood %in% c('Union Square','Downtown'))
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
# 'pet premium'
pets_premium <- cr_unique %>% mutate(., pets_ok=ifelse(dogs_allowed==0&cats_allowed==0, "No", "Yes")) %>%
group_by(., neighborhood, pets_ok) %>%
summarise(., price = round(mean(price))) %>%
spread(., pets_ok, price) %>%
mutate(., More = Yes - No, Perc = round(More/No*100), Perc=ifelse(is.na(Perc),0,Perc))
ggplot(pets_premium #%>% filter(., !neighborhood %in% c('Union Square','Downtown'))
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
# 'pet premium'
pets_premium <- cr_unique %>% mutate(., pets_ok=ifelse(dogs_allowed==0&cats_allowed==0, "No", "Yes")) %>%
group_by(., neighborhood, pets_ok) %>%
summarise(., price = round(median(price))) %>%
spread(., pets_ok, price) %>%
mutate(., More = Yes - No, Perc = round(More/No*100), Perc=ifelse(is.na(Perc),0,Perc))
ggplot(pets_premium %>% filter(., !neighborhood %in% c('Union Square','Downtown'))
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
# 'pet premium'
pets_premium <- cr_unique %>% mutate(., pets_ok=ifelse(dogs_allowed==0&cats_allowed==0, "No", "Yes")) %>%
group_by(., neighborhood, pets_ok) %>%
summarise(., price = round(mean(price))) %>%
spread(., pets_ok, price) %>%
mutate(., More = Yes - No, Perc = round(More/No*100), Perc=ifelse(is.na(Perc),0,Perc))
ggplot(pets_premium %>% filter(., !neighborhood %in% c('Union Square','Downtown'))
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 3, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
ggplot(pets_premium %>% filter(., !neighborhood %in% c('Union Square','Downtown'))
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 3, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
ggplot(pets_premium %>% filter(., !neighborhood %in% c('Union Square','Downtown'))
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 3, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 13, height = 5)
ggplot(pets_premium %>% filter(., !neighborhood %in% c('Union Square','Downtown'))
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 3, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
ggplot(pets_premium %>% filter(., !neighborhood %in% c('Union Square','Downtown'))
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 3, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("Average Price(Pets Ok)/Average Price(Pets Not OK) in Percentage")+
xlab("") +theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 3, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("Average Price(Pets Ok)/Average Price(Pets Not OK) in Percentage")+
xlab("") +theme(axis.text=element_text(size=10),
axis.title=element_text(size=12),
strip.text.x = element_text(size = 13, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
ggplot(pets_premium %>% filter(., !neighborhood %in% c('Union Square','Downtown'))
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 3, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("Average Price(Pets Ok)/Average Price(Pets Not OK) in Percentage")+
xlab("") +theme(axis.text=element_text(size=10),
axis.title=element_text(size=12),
strip.text.x = element_text(size = 13, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
ggplot(pets_premium %>% filter(., !neighborhood %in% c('Union Square','Downtown'))
, aes(neighborhood, Perc, label=paste0(Perc,'%'))) +
coord_flip()+
geom_col(aes(x=reorder(neighborhood, Perc)),fill = '#5815AD') +
geom_text(size = 3, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
ylab("Average Price for (Pets Ok - Pets Not Ok)/Pets Not Ok in (%)")+
xlab("") +theme(axis.text=element_text(size=10),
axis.title=element_text(size=12),
strip.text.x = element_text(size = 13, face="bold",colour = "#5815AD", angle = 0,)) +
ggsave("./ppt/nyc_pet_premium.png", width = 10, height = 5)
# what neighborhood in NYC has the most pets allowed listings?
pet_friendly <- cr_unique %>% group_by(., neighborhood) %>% summarise(., dogs_ok = sum(dogs_allowed), cats_ok = sum(cats_allowed)) %>%
left_join(.,cr_unique %>% group_by(., neighborhood) %>% summarise(., total_listing=n()), by = 'neighborhood') %>%
mutate(., cat_friendly = round(cats_ok/total_listing*100,2),
dog_friendly = round(dogs_ok/total_listing*100,2))
ggplot(pet_friendly %>% gather(.,key=key,value=value,c('cat_friendly','dog_friendly')),
aes(x=neighborhood,y=value,label=paste0(value,'%'))) +
coord_flip() +
geom_col(aes(x=reorder(neighborhood, value)), fill='#5815AD') +
geom_text(size = 5, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
facet_wrap(~key, scales = "free")+
ylab("pet allowed listings / total listings (%)") +
xlab("") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0)) +
ggsave("./ppt/nyc_pet_friendly.png", width = 10, height = 5)
ggplot(pet_friendly %>% gather(.,key=key,value=value,c('cat_friendly','dog_friendly')),
aes(x=neighborhood,y=value,label=paste0(value,'%'))) +
coord_flip() +
geom_col(aes(x=reorder(neighborhood, value)), fill='#5815AD') +
geom_text(size = 5, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
facet_wrap(~key)+
ylab("pet allowed listings / total listings (%)") +
xlab("") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0)) +
ggsave("./ppt/nyc_pet_friendly.png", width = 10, height = 5)
# what neighborhood in NYC has the most pets allowed listings?
pet_friendly <- cr_unique %>% group_by(., neighborhood) %>% summarise(., dogs_ok = sum(dogs_allowed), cats_ok = sum(cats_allowed)) %>%
left_join(.,cr_unique %>% group_by(., neighborhood) %>% summarise(., total_listing=n()), by = 'neighborhood') %>%
mutate(., cat_friendly = round(cats_ok/total_listing*100,2),
dog_friendly = round(dogs_ok/total_listing*100,2))
ggplot(pet_friendly %>% gather(.,key=key,value=value,c('cat_friendly','dog_friendly')),
aes(x=neighborhood,y=value,label=paste0(value,'%'))) +
coord_flip() +
geom_col(aes(x=reorder(neighborhood, value)), fill='#5815AD') +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
facet_wrap(~key)+
ylab("pet allowed listings / total listings (%)") +
xlab("") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0)) +
ggsave("./ppt/nyc_pet_friendly.png", width = 10, height = 5)
ggplot(pet_friendly %>% gather(.,key=key,value=value,c('cat_friendly','dog_friendly')) %>% filter(., !neighborhood %in% c('Union Square','Downtown')),
aes(x=neighborhood,y=value,label=paste0(value,'%'))) +
coord_flip() +
geom_col(aes(x=reorder(neighborhood, value)), fill='#5815AD') +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
facet_wrap(~key)+
ylab("pet allowed listings / total listings (%)") +
xlab("") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16,face="bold"),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0)) +
ggsave("./ppt/nyc_pet_friendly.png", width = 10, height = 5)
# what neighborhood in NYC has the most pets allowed listings?
pet_friendly <- cr_unique %>% group_by(., neighborhood) %>% summarise(., dogs_ok = sum(dogs_allowed), cats_ok = sum(cats_allowed)) %>%
left_join(.,cr_unique %>% group_by(., neighborhood) %>% summarise(., total_listing=n()), by = 'neighborhood') %>%
mutate(., cat_friendly = round(cats_ok/total_listing*100,2),
dog_friendly = round(dogs_ok/total_listing*100,2))
ggplot(pet_friendly %>% gather(.,key=key,value=value,c('cat_friendly','dog_friendly')) %>% filter(., !neighborhood %in% c('Union Square','Downtown')),
aes(x=neighborhood,y=value,label=paste0(value,'%'))) +
coord_flip() +
geom_col(aes(x=reorder(neighborhood, value)), fill='#5815AD') +
geom_text(size = 4, color='#FCFBFF',position = position_stack(reverse = T,vjust = 0.5)) +
facet_wrap(~key)+
ylab("pet allowed listings / total listings (%)") +
xlab("") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=12),
strip.text.x = element_text(size = 14, face="bold",colour = "#5815AD", angle = 0)) +
ggsave("./ppt/nyc_pet_friendly.png", width = 10, height = 5)
pet_friendly
